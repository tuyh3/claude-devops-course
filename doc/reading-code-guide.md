# å®æˆ˜é˜…è¯»ä»£ç æŒ‡å— - ä»ç•Œé¢åˆ°ä»£ç çš„å®Œæ•´å®šä½æµç¨‹

> ğŸ¯ **æœ¬æŒ‡å—å®šä½**ï¼šé¢å‘å®é™…å·¥ä½œåœºæ™¯ï¼Œæ•™ä½ å¦‚ä½•å¿«é€Ÿå®šä½å’Œç†è§£ä»£ç ã€‚è¿™ä¸æ˜¯ç†è®ºå­¦ä¹ ï¼Œè€Œæ˜¯å®æˆ˜æŠ€å·§ã€‚

---

## ğŸ“‹ ç›®å½•

- [å‰ç½®æ¡ä»¶](#å‰ç½®æ¡ä»¶)
- [ç¬¬ä¸€ç« ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®](#ç¬¬ä¸€ç« å¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®)
- [ç¬¬äºŒç« ï¼šä»ç•Œé¢åŠŸèƒ½å®šä½åˆ°ä»£ç ](#ç¬¬äºŒç« ä»ç•Œé¢åŠŸèƒ½å®šä½åˆ°ä»£ç )
- [ç¬¬ä¸‰ç« ï¼šç”¨æ—¥å¿—å®šä½é—®é¢˜](#ç¬¬ä¸‰ç« ç”¨æ—¥å¿—å®šä½é—®é¢˜)
- [ç¬¬å››ç« ï¼šç”¨æ–­ç‚¹è°ƒè¯•è¿½è¸ªæµç¨‹](#ç¬¬å››ç« ç”¨æ–­ç‚¹è°ƒè¯•è¿½è¸ªæµç¨‹)
- [ç¬¬äº”ç« ï¼šé˜…è¯»å¤æ‚ä»£ç çš„æŠ€å·§](#ç¬¬äº”ç« é˜…è¯»å¤æ‚ä»£ç çš„æŠ€å·§)
- [ç¬¬å…­ç« ï¼šå®æˆ˜æ¡ˆä¾‹ - å®šä½ä¸€ä¸ª Bug](#ç¬¬å…­ç« å®æˆ˜æ¡ˆä¾‹---å®šä½ä¸€ä¸ª-bug)

---

## å‰ç½®æ¡ä»¶

åœ¨é˜…è¯»æœ¬æŒ‡å—ä¹‹å‰ï¼Œä½ åº”è¯¥ï¼š

âœ… å·²è¯»å®Œã€ŠSpring Boot é›¶åŸºç¡€å…¥é—¨æŒ‡å—ã€‹ï¼ˆ`05-spring-boot-beginner-guide.md`ï¼‰
âœ… ç†è§£ä¸‰å±‚æ¶æ„ï¼ˆController-Service-Repositoryï¼‰
âœ… ç†è§£ IoCã€ä¾èµ–æ³¨å…¥ç­‰æ ¸å¿ƒæ¦‚å¿µ
âœ… çŸ¥é“åŸºæœ¬æ³¨è§£çš„å«ä¹‰ï¼ˆ@RestControllerã€@Service ç­‰ï¼‰

**å¦‚æœæ²¡æœ‰ä¸Šè¿°åŸºç¡€ï¼Œè¯·å…ˆé˜…è¯»å…¥é—¨æŒ‡å—ï¼**

---

## ç¬¬ä¸€ç« ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®

### 1.1 åœºæ™¯ï¼šç¬¬ä¸€å¤©å…¥èŒï¼Œæ‹¿åˆ°é¡¹ç›®ä»£ç 

ä½ åˆšå…¥èŒä¸€å®¶å…¬å¸ï¼Œå›¢é˜Ÿ Leader æŠŠé¡¹ç›®ä»£ç å…‹éš†ç»™ä½ ï¼š

```bash
git clone <project-url>
cd claude-devops-course
```

**é—®é¢˜æ¥äº†**ï¼šè¿™ä¸ªé¡¹ç›®æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿä»£ç æ€ä¹ˆç»„ç»‡çš„ï¼Ÿä»å“ªé‡Œå¼€å§‹çœ‹ï¼Ÿ

**ä¸è¦æ…Œï¼æŒ‰ç…§è¿™ä¸ª5åˆ†é’Ÿå¿«é€Ÿäº†è§£æµç¨‹ï¼š**

### 1.2 ç¬¬1åˆ†é’Ÿï¼šçœ‹ README.md

**ç›®çš„**ï¼šäº†è§£é¡¹ç›®æ˜¯ä»€ä¹ˆã€åšä»€ä¹ˆç”¨

```bash
cat README.md
```

**é‡ç‚¹çœ‹**ï¼š
1. **é¡¹ç›®ç®€ä»‹**ï¼šè¿™æ˜¯ä¸€ä¸ªç”µä¿¡ä¸šåŠ¡ç³»ç»Ÿï¼ˆTCBS + TCOAï¼‰
2. **æŠ€æœ¯æ ˆ**ï¼šSpring Boot 3.3.8 + Java 21 + Oracle 19c RAC
3. **å¿«é€Ÿå¼€å§‹**ï¼šå¦‚ä½•è¿è¡Œé¡¹ç›®
4. **æ–‡æ¡£ä½ç½®**ï¼š`doc/` ç›®å½•

**èŠ±è´¹æ—¶é—´**ï¼š1 åˆ†é’Ÿ

### 1.3 ç¬¬2åˆ†é’Ÿï¼šçœ‹ build.gradleï¼ˆäº†è§£ä¾èµ–ï¼‰

**ç›®çš„**ï¼šçŸ¥é“é¡¹ç›®ç”¨äº†å“ªäº›æŠ€æœ¯æ¡†æ¶

```bash
cat build.gradle
```

**é‡ç‚¹çœ‹ dependencies éƒ¨åˆ†**ï¼š

```groovy
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'      // Web æ¡†æ¶
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa' // æ•°æ®åº“ ORM
    implementation 'com.oracle.database.jdbc:ojdbc11'                      // Oracle é©±åŠ¨
    compileOnly 'org.projectlombok:lombok'                                 // ç®€åŒ–ä»£ç 
    // ...
}
```

**ä½ ç°åœ¨çŸ¥é“äº†**ï¼š
- âœ… è¿™æ˜¯ä¸€ä¸ª Web é¡¹ç›®ï¼ˆæœ‰ spring-boot-starter-webï¼‰
- âœ… ç”¨ JPA æ“ä½œæ•°æ®åº“ï¼ˆæœ‰ spring-boot-starter-data-jpaï¼‰
- âœ… æ•°æ®åº“æ˜¯ Oracleï¼ˆæœ‰ ojdbc11ï¼‰
- âœ… ç”¨äº† Lombokï¼ˆç®€åŒ– getter/setterï¼‰

**èŠ±è´¹æ—¶é—´**ï¼š1 åˆ†é’Ÿ

### 1.4 ç¬¬3åˆ†é’Ÿï¼šçœ‹ application.ymlï¼ˆäº†è§£é…ç½®ï¼‰

**ç›®çš„**ï¼šçŸ¥é“é¡¹ç›®è¿æ¥äº†å“ªäº›æœåŠ¡

```bash
cat src/main/resources/application.yml
```

**é‡ç‚¹çœ‹**ï¼š

```yaml
server:
  port: 8080  # åº”ç”¨è¿è¡Œåœ¨ 8080 ç«¯å£

spring:
  datasource:
    url: jdbc:oracle:thin:@//192.168.1.66:1521/DBPV  # Oracle æ•°æ®åº“åœ°å€
    username: TCBS
    driver-class-name: oracle.jdbc.OracleDriver

  jpa:
    hibernate:
      ddl-auto: none  # ä¸è‡ªåŠ¨åˆ›å»ºè¡¨
    show-sql: true    # æ‰“å° SQLï¼ˆå¼€å‘æ—¶å¾ˆæœ‰ç”¨ï¼‰
```

**ä½ ç°åœ¨çŸ¥é“äº†**ï¼š
- âœ… åº”ç”¨è¿è¡Œåœ¨ `localhost:8080`
- âœ… è¿æ¥åˆ° Oracle æ•°æ®åº“ï¼ˆ192.168.1.66:1521ï¼‰
- âœ… ä½¿ç”¨çš„ schema æ˜¯ `TCBS`
- âœ… å¼€å‘ç¯å¢ƒä¼šæ‰“å° SQLï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰

**èŠ±è´¹æ—¶é—´**ï¼š1 åˆ†é’Ÿ

### 1.5 ç¬¬4åˆ†é’Ÿï¼šçœ‹ç›®å½•ç»“æ„

**ç›®çš„**ï¼šäº†è§£ä»£ç æ€ä¹ˆç»„ç»‡çš„

```bash
tree src/main/java/com/devops/course -L 2
```

**è¾“å‡º**ï¼š

```
src/main/java/com/devops/course/
â”œâ”€â”€ Main.java                    # åº”ç”¨å…¥å£
â”œâ”€â”€ controller/                  # æ§åˆ¶å™¨å±‚ï¼ˆæ¥æ”¶ HTTP è¯·æ±‚ï¼‰
â”‚   â”œâ”€â”€ HelloController.java
â”‚   â””â”€â”€ CustomerController.java
â”œâ”€â”€ service/                     # æœåŠ¡å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â””â”€â”€ CustomerService.java
â”œâ”€â”€ repository/                  # æ•°æ®è®¿é—®å±‚ï¼ˆæ•°æ®åº“æ“ä½œï¼‰
â”‚   â””â”€â”€ CustomerRepository.java
â””â”€â”€ entity/                      # å®ä½“ç±»ï¼ˆå¯¹åº”æ•°æ®åº“è¡¨ï¼‰
    â””â”€â”€ Customer.java
```

**ä½ ç°åœ¨çŸ¥é“äº†**ï¼š
- âœ… è¿™æ˜¯æ ‡å‡†çš„ä¸‰å±‚æ¶æ„
- âœ… Controller å±‚åœ¨ `controller/` ç›®å½•
- âœ… Service å±‚åœ¨ `service/` ç›®å½•
- âœ… Repository å±‚åœ¨ `repository/` ç›®å½•
- âœ… Entity åœ¨ `entity/` ç›®å½•

**èŠ±è´¹æ—¶é—´**ï¼š1 åˆ†é’Ÿ

### 1.6 ç¬¬5åˆ†é’Ÿï¼šæ‰¾åˆ°å…¥å£ç‚¹å¹¶è¿è¡Œ

**ç›®çš„**ï¼šæ‰¾åˆ°åº”ç”¨çš„å¯åŠ¨å…¥å£ï¼Œè¿è¡Œèµ·æ¥

**æ­¥éª¤1ï¼šæ‰¾å…¥å£**

```bash
cat src/main/java/com/devops/course/Main.java
```

```java
@SpringBootApplication
public class Main {
    public static void main(String[] args) {
        SpringApplication.run(Main.class, args);
    }
}
```

**æ­¥éª¤2ï¼šè¿è¡Œé¡¹ç›®**

```bash
./gradlew bootRun
```

**æ­¥éª¤3ï¼šè®¿é—®ç¬¬ä¸€ä¸ª API**

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:8080/api/hello`

```json
{
  "message": "Hello, Spring Boot!",
  "status": "success"
}
```

**æ­å–œï¼5åˆ†é’Ÿä½ å·²ç»å¯¹é¡¹ç›®æœ‰åŸºæœ¬äº†è§£äº†ï¼**

**èŠ±è´¹æ—¶é—´**ï¼š1 åˆ†é’Ÿ

---

## ç¬¬äºŒç« ï¼šä»ç•Œé¢åŠŸèƒ½å®šä½åˆ°ä»£ç 

> ğŸ’¡ **æœ€é‡è¦çš„æŠ€èƒ½**ï¼šè¿™æ˜¯æ—¥å¸¸å·¥ä½œä¸­æœ€å¸¸ç”¨çš„æŠ€èƒ½ï¼Œå¿…é¡»æŒæ¡ï¼

### 2.1 åœºæ™¯1ï¼šç”¨æˆ·ç‚¹å‡»"æŸ¥è¯¢å®¢æˆ·åˆ—è¡¨"æŒ‰é’®

**èƒŒæ™¯**ï¼šäº§å“ç»ç†è¯´"å®¢æˆ·åˆ—è¡¨é¡µé¢åŠ è½½å¾ˆæ…¢ï¼Œå¸®æˆ‘çœ‹çœ‹æ˜¯ä»€ä¹ˆé—®é¢˜"ã€‚

**ä½ çš„ä»»åŠ¡**ï¼šæ‰¾åˆ°è¿™ä¸ªåŠŸèƒ½å¯¹åº”çš„ä»£ç åœ¨å“ªé‡Œã€‚

#### æ­¥éª¤1ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®å®¢æˆ·åˆ—è¡¨é¡µé¢
2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° `Network`ï¼ˆç½‘ç»œï¼‰é¢æ¿
4. ç‚¹å‡»"æŸ¥è¯¢å®¢æˆ·åˆ—è¡¨"æŒ‰é’®

#### æ­¥éª¤2ï¼šæ‰¾åˆ° HTTP è¯·æ±‚

åœ¨ Network é¢æ¿ä¸­çœ‹åˆ°ï¼š

```
Method: GET
URL: http://localhost:8080/api/customers
Status: 200 OK
Time: 2.35s  â† ç¡®å®æ…¢ï¼
```

**å…³é”®ä¿¡æ¯**ï¼š
- **è¯·æ±‚æ–¹æ³•**ï¼š`GET`
- **URL è·¯å¾„**ï¼š`/api/customers`

#### æ­¥éª¤3ï¼šæ ¹æ® URL æ‰¾ Controller

**è§„å¾‹**ï¼šURL è·¯å¾„å¯¹åº” Controller çš„ `@RequestMapping` å’Œæ–¹æ³•çš„ `@GetMapping`

```java
// æ‰¾ Controller çš„æ€è·¯ï¼š
// URL: /api/customers
// â†“
// @RequestMapping("/api/customers")
```

**åœ¨ IDEA ä¸­æœç´¢**ï¼š

1. æŒ‰ `Ctrl + Shift + F`ï¼ˆå…¨å±€æœç´¢ï¼‰
2. æœç´¢ï¼š`@RequestMapping("/api/customers")`
3. æ‰¾åˆ°ï¼š`CustomerController.java`

```java
@RestController
@RequestMapping("/api/customers")  // â† æ‰¾åˆ°äº†ï¼
public class CustomerController {

    @GetMapping  // â† GET æ–¹æ³•ï¼Œæ²¡æœ‰é¢å¤–è·¯å¾„ï¼Œå°±æ˜¯ /api/customers
    public ResponseEntity<List<Customer>> getAllCustomers() {
        List<Customer> customers = customerService.findAllCustomers();
        return ResponseEntity.ok(customers);
    }
}
```

**ä½ ç°åœ¨çŸ¥é“äº†**ï¼š
- âœ… ä»£ç ä½ç½®ï¼š`CustomerController.java:getAllCustomers()` æ–¹æ³•
- âœ… è°ƒç”¨äº† `customerService.findAllCustomers()`

#### æ­¥éª¤4ï¼šè¿½è¸ªåˆ° Service å±‚

ç‚¹å‡» `findAllCustomers()`ï¼Œè·³è½¬åˆ° `CustomerService.java`ï¼š

```java
@Service
public class CustomerService {

    @Autowired
    private CustomerRepository customerRepository;

    public List<Customer> findAllCustomers() {
        return customerRepository.findAll();  // â† è°ƒç”¨ Repository
    }
}
```

#### æ­¥éª¤5ï¼šè¿½è¸ªåˆ° Repository å±‚

ç‚¹å‡» `findAll()`ï¼Œè·³è½¬åˆ° `CustomerRepository.java`ï¼š

```java
@Repository
public interface CustomerRepository extends JpaRepository<Customer, String> {
    // findAll() æ˜¯ç»§æ‰¿è‡ª JpaRepository çš„æ–¹æ³•
    // è‡ªåŠ¨ç”Ÿæˆ SQL: SELECT * FROM TCBS.CUSTOMERS
}
```

**å®Œæ•´è°ƒç”¨é“¾**ï¼š

```
æµè§ˆå™¨
  â†“ GET /api/customers
CustomerController.getAllCustomers()
  â†“ customerService.findAllCustomers()
CustomerService.findAllCustomers()
  â†“ customerRepository.findAll()
CustomerRepository.findAll()
  â†“ æ‰§è¡Œ SQL: SELECT * FROM TCBS.CUSTOMERS
Oracle æ•°æ®åº“
  â†“ è¿”å› 10000 æ¡æ•°æ®
æµè§ˆå™¨ï¼ˆæ˜¾ç¤ºå®¢æˆ·åˆ—è¡¨ï¼‰
```

**é—®é¢˜åˆ†æ**ï¼š
- æ•°æ®åº“é‡Œæœ‰ 10000 ä¸ªå®¢æˆ·
- ä¸€æ¬¡æ€§æŸ¥è¯¢æ‰€æœ‰å®¢æˆ·ï¼Œæ²¡æœ‰åˆ†é¡µ
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ åˆ†é¡µåŠŸèƒ½

**å®šä½æ—¶é—´**ï¼š2 åˆ†é’Ÿ

---

### 2.2 åœºæ™¯2ï¼šç•Œé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

**èƒŒæ™¯**ï¼šç”¨æˆ·ç‚¹å‡»"åˆ›å»ºå®¢æˆ·"æŒ‰é’®åï¼Œç•Œé¢å¼¹å‡ºé”™è¯¯ï¼š"500 Internal Server Error"

#### æ­¥éª¤1ï¼šçœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼ˆConsoleï¼‰

æŒ‰ `F12` â†’ `Console` é¢æ¿ï¼Œçœ‹åˆ°ï¼š

```
POST http://localhost:8080/api/customers 500 (Internal Server Error)
```

#### æ­¥éª¤2ï¼šçœ‹ Network é¢æ¿çš„ Response

ç‚¹å‡»è¿™ä¸ªè¯·æ±‚ â†’ `Response` æ ‡ç­¾é¡µï¼š

```json
{
  "timestamp": "2025-11-17T10:30:00.123Z",
  "status": 500,
  "error": "Internal Server Error",
  "message": "could not execute statement; SQL [insert into TCBS.CUSTOMERS ...]",
  "path": "/api/customers"
}
```

**å…³é”®ä¿¡æ¯**ï¼š
- âŒ æ•°æ®åº“æ’å…¥å¤±è´¥
- âŒ SQL è¯­å¥æœ‰é—®é¢˜

#### æ­¥éª¤3ï¼šçœ‹æœåŠ¡ç«¯æ—¥å¿—

åˆ‡æ¢åˆ° IDEA çš„ `Run` çª—å£ï¼ˆæˆ–è€…å‘½ä»¤è¡Œï¼‰ï¼Œçœ‹åˆ°å®Œæ•´çš„å †æ ˆè·Ÿè¸ªï¼š

```
2025-11-17 10:30:00.123 ERROR 12345 --- [nio-8080-exec-1] o.h.engine.jdbc.spi.SqlExceptionHelper   :
ORA-00001: unique constraint (TCBS.CUSTOMERS_PK) violated

java.sql.SQLIntegrityConstraintViolationException: ORA-00001: unique constraint (TCBS.CUSTOMERS_PK) violated
    at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:509)
    at com.devops.course.controller.CustomerController.createCustomer(CustomerController.java:45)
    at com.devops.course.service.CustomerService.saveCustomer(CustomerService.java:32)
    at com.devops.course.repository.CustomerRepository.save(CustomerRepository.java)
```

**å…³é”®ä¿¡æ¯**ï¼š
- âŒ `ORA-00001: unique constraint violated`ï¼šä¸»é”®å†²çª
- âŒ åœ¨ `CustomerController.java:45` è¡Œ

#### æ­¥éª¤4ï¼šå®šä½åˆ°å…·ä½“ä»£ç è¡Œ

æ‰“å¼€ `CustomerController.java`ï¼Œè·³è½¬åˆ°ç¬¬ 45 è¡Œï¼š

```java
@PostMapping
public ResponseEntity<Customer> createCustomer(@RequestBody Customer customer) {
    Customer savedCustomer = customerService.saveCustomer(customer);  // â† ç¬¬45è¡Œ
    return ResponseEntity.status(HttpStatus.CREATED).body(savedCustomer);
}
```

**é—®é¢˜åˆ†æ**ï¼š
- ç”¨æˆ·è¯•å›¾åˆ›å»ºä¸€ä¸ª `customer_id` å·²å­˜åœ¨çš„å®¢æˆ·
- æ•°æ®åº“ä¸»é”®å†²çª
- **è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨æ’å…¥å‰æ£€æŸ¥ ID æ˜¯å¦å·²å­˜åœ¨

**å®šä½æ—¶é—´**ï¼š3 åˆ†é’Ÿ

---

### 2.3 åœºæ™¯3ï¼šæ•°æ®ä¸å¯¹ï¼ˆæŸ¥è¯¢ç»“æœæœ‰é—®é¢˜ï¼‰

**èƒŒæ™¯**ï¼šäº§å“ç»ç†è¯´"å®¢æˆ·åˆ—è¡¨é‡Œæ˜¾ç¤ºäº†å·²åˆ é™¤çš„å®¢æˆ·ï¼Œåº”è¯¥åªæ˜¾ç¤ºæ´»è·ƒå®¢æˆ·"

#### æ­¥éª¤1ï¼šç¡®è®¤å½“å‰è¡Œä¸º

è®¿é—®ï¼š`http://localhost:8080/api/customers`

è¿”å›ç»“æœåŒ…å«ï¼š

```json
[
  {
    "customerId": "CUST001",
    "customerName": "å¼ ä¸‰",
    "status": "ACTIVE"  â† æ´»è·ƒå®¢æˆ·
  },
  {
    "customerId": "CUST002",
    "customerName": "æå››",
    "status": "DELETED"  â† å·²åˆ é™¤çš„å®¢æˆ·ï¼ˆä¸åº”è¯¥æ˜¾ç¤ºï¼‰
  }
]
```

#### æ­¥éª¤2ï¼šæ‰¾åˆ°å¯¹åº”ä»£ç 

æ ¹æ® URL `/api/customers`ï¼Œæ‰¾åˆ° `CustomerController.getAllCustomers()`ï¼š

```java
@GetMapping
public ResponseEntity<List<Customer>> getAllCustomers() {
    List<Customer> customers = customerService.findAllCustomers();  // â† æŸ¥è¯¢æ‰€æœ‰
    return ResponseEntity.ok(customers);
}
```

#### æ­¥éª¤3ï¼šè¿½è¸ªåˆ° Service

```java
public List<Customer> findAllCustomers() {
    return customerRepository.findAll();  // â† è¿™é‡ŒæŸ¥è¯¢äº†æ‰€æœ‰å®¢æˆ·ï¼ŒåŒ…æ‹¬å·²åˆ é™¤çš„
}
```

#### æ­¥éª¤4ï¼šæ£€æŸ¥ Repository

```java
@Repository
public interface CustomerRepository extends JpaRepository<Customer, String> {
    // findAll() æŸ¥è¯¢æ‰€æœ‰è®°å½•ï¼Œä¸è¿‡æ»¤ status
}
```

**é—®é¢˜åˆ†æ**ï¼š
- å½“å‰ä»£ç ï¼š`findAll()` æŸ¥è¯¢æ‰€æœ‰å®¢æˆ·
- æœŸæœ›è¡Œä¸ºï¼šåªæŸ¥è¯¢ `status = 'ACTIVE'` çš„å®¢æˆ·
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ `findByStatus("ACTIVE")`

**ä¿®æ”¹ä»£ç **ï¼š

```java
// Service å±‚
public List<Customer> findAllCustomers() {
    return customerRepository.findByStatus("ACTIVE");  // åªæŸ¥è¯¢æ´»è·ƒå®¢æˆ·
}

// Repository å±‚ï¼ˆæ·»åŠ æ–¹æ³•ï¼‰
List<Customer> findByStatus(String status);
```

**å®šä½æ—¶é—´**ï¼š2 åˆ†é’Ÿ

---

### 2.4 å®šä½æŠ€å·§æ€»ç»“

| åœºæ™¯ | å®šä½æ–¹æ³• | å…³é”®å·¥å…· |
|------|---------|---------|
| **ç•Œé¢åŠŸèƒ½ â†’ ä»£ç ** | URL â†’ Controller â†’ Service â†’ Repository | F12 Network é¢æ¿ |
| **ç•Œé¢æŠ¥é”™** | çœ‹ Response â†’ çœ‹æœåŠ¡ç«¯æ—¥å¿— â†’ å®šä½ä»£ç è¡Œ | Console + æ—¥å¿— |
| **æ•°æ®ä¸å¯¹** | ç¡®è®¤å½“å‰è¡Œä¸º â†’ è¿½è¸ªä»£ç é€»è¾‘ â†’ æ‰¾åˆ°é—®é¢˜ç‚¹ | æ–­ç‚¹è°ƒè¯• |

**æ ¸å¿ƒæŠ€èƒ½**ï¼š
1. âœ… ä¼šç”¨æµè§ˆå™¨ F12ï¼ˆNetworkã€Consoleï¼‰
2. âœ… ä¼šçœ‹æœåŠ¡ç«¯æ—¥å¿—ï¼ˆå †æ ˆè·Ÿè¸ªï¼‰
3. âœ… ä¼šè¿½è¸ªä»£ç è°ƒç”¨é“¾ï¼ˆController â†’ Service â†’ Repositoryï¼‰

---

## ç¬¬ä¸‰ç« ï¼šç”¨æ—¥å¿—å®šä½é—®é¢˜

### 3.1 ç†è§£æ—¥å¿—çº§åˆ«

Spring Boot ä½¿ç”¨ Logback è®°å½•æ—¥å¿—ï¼Œæœ‰ 5 ä¸ªçº§åˆ«ï¼š

| çº§åˆ« | å«ä¹‰ | ä½¿ç”¨åœºæ™¯ | æ˜¯å¦æ‰“å°åˆ°æ§åˆ¶å° |
|------|------|---------|----------------|
| **ERROR** | é”™è¯¯ | ç¨‹åºå‡ºé”™äº†ï¼Œå½±å“åŠŸèƒ½ | âœ… é»˜è®¤æ‰“å° |
| **WARN** | è­¦å‘Š | æœ‰é—®é¢˜ï¼Œä½†ä¸å½±å“è¿è¡Œ | âœ… é»˜è®¤æ‰“å° |
| **INFO** | ä¿¡æ¯ | ä¸€èˆ¬ä¿¡æ¯ï¼ˆå¯åŠ¨ã€å…³é—­ç­‰ï¼‰ | âœ… é»˜è®¤æ‰“å° |
| **DEBUG** | è°ƒè¯• | è¯¦ç»†ä¿¡æ¯ï¼ˆæ–¹æ³•è°ƒç”¨ã€å˜é‡å€¼ï¼‰ | âŒ é»˜è®¤ä¸æ‰“å° |
| **TRACE** | è¿½è¸ª | è¶…è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯ä¸€æ­¥ï¼‰ | âŒ é»˜è®¤ä¸æ‰“å° |

**é»˜è®¤çº§åˆ«**ï¼šINFOï¼ˆåªæ‰“å° INFOã€WARNã€ERRORï¼‰

### 3.2 å¦‚ä½•çœ‹å †æ ˆè·Ÿè¸ªï¼ˆStack Traceï¼‰

**ç¤ºä¾‹æ—¥å¿—**ï¼š

```
2025-11-17 10:30:00.123 ERROR 12345 --- [nio-8080-exec-1] o.a.c.c.C.[.[.[/].[dispatcherServlet]    :
Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
[Request processing failed; nested exception is java.lang.NullPointerException: Cannot invoke
"com.devops.course.entity.Customer.getCustomerName()" because "customer" is null]
with root cause

java.lang.NullPointerException: Cannot invoke "getCustomerName()" because "customer" is null
    at com.devops.course.service.CustomerService.processCustomer(CustomerService.java:42)
    at com.devops.course.controller.CustomerController.updateCustomer(CustomerController.java:67)
    at jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
    at java.base/java.lang.reflect.Method.invoke(Method.java:580)
    at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(...)
    ...
```

**æ€ä¹ˆçœ‹ï¼Ÿ**

#### æ­¥éª¤1ï¼šçœ‹é”™è¯¯ç±»å‹å’ŒåŸå› 

```
java.lang.NullPointerException: Cannot invoke "getCustomerName()" because "customer" is null
```

- **é”™è¯¯ç±»å‹**ï¼š`NullPointerException`ï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰
- **åŸå› **ï¼š`customer` æ˜¯ `null`ï¼Œæ— æ³•è°ƒç”¨ `getCustomerName()`

#### æ­¥éª¤2ï¼šçœ‹ç¬¬ä¸€è¡Œå †æ ˆï¼ˆæœ€æ¥è¿‘é—®é¢˜çš„åœ°æ–¹ï¼‰

```
at com.devops.course.service.CustomerService.processCustomer(CustomerService.java:42)
```

- **ç±»**ï¼š`CustomerService`
- **æ–¹æ³•**ï¼š`processCustomer`
- **æ–‡ä»¶**ï¼š`CustomerService.java`
- **è¡Œå·**ï¼š**ç¬¬ 42 è¡Œ** â† é—®é¢˜å°±åœ¨è¿™é‡Œï¼

#### æ­¥éª¤3ï¼šåœ¨ IDEA ä¸­è·³è½¬

1. ç‚¹å‡»æ—¥å¿—ä¸­çš„ `CustomerService.java:42`
2. IDEA è‡ªåŠ¨è·³è½¬åˆ°ç¬¬ 42 è¡Œ
3. çœ‹ä»£ç ï¼š

```java
public void processCustomer(String customerId) {
    Customer customer = customerRepository.findById(customerId).orElse(null);
    String name = customer.getCustomerName();  // â† ç¬¬42è¡Œï¼Œcustomer æ˜¯ nullï¼
    // ...
}
```

**é—®é¢˜åˆ†æ**ï¼š
- `findById` æ²¡æ‰¾åˆ°å®¢æˆ·ï¼Œè¿”å› `null`
- ç›´æ¥è°ƒç”¨ `customer.getCustomerName()` å¯¼è‡´ NPE
- **è§£å†³æ–¹æ¡ˆ**ï¼šå…ˆåˆ¤æ–­ `customer` æ˜¯å¦ä¸º `null`

### 3.3 æ ¹æ®æ—¥å¿—å®šä½ä»£ç è¡Œ

**æŠ€å·§1ï¼šçœ‹å †æ ˆçš„å‰3è¡Œ**

```
java.lang.NullPointerException: ...
    at com.devops.course.service.CustomerService.processCustomer(CustomerService.java:42)  â† é—®é¢˜æ‰€åœ¨
    at com.devops.course.controller.CustomerController.updateCustomer(CustomerController.java:67)  â† è°è°ƒç”¨çš„
    at jdk.internal.reflect...  â† Spring æ¡†æ¶å†…éƒ¨ï¼Œå¿½ç•¥
```

- **ç¬¬1è¡Œ**ï¼šé—®é¢˜å‘ç”Ÿçš„åœ°æ–¹ï¼ˆCustomerService:42ï¼‰
- **ç¬¬2è¡Œ**ï¼šè°è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼ˆCustomerController:67ï¼‰
- **ç¬¬3è¡ŒåŠä»¥å**ï¼šSpring æ¡†æ¶å†…éƒ¨ï¼Œé€šå¸¸å¿½ç•¥

**æŠ€å·§2ï¼šè¿‡æ»¤è‡ªå·±çš„ä»£ç **

å †æ ˆè·Ÿè¸ªå¾ˆé•¿ï¼Œåªçœ‹ `com.devops.course` åŒ…ä¸‹çš„ä»£ç ï¼š

```
at com.devops.course.service.CustomerService.processCustomer(CustomerService.java:42)  â† çœ‹è¿™ä¸ª
at com.devops.course.controller.CustomerController.updateCustomer(CustomerController.java:67)  â† çœ‹è¿™ä¸ª
at org.springframework...  â† å¿½ç•¥
at java.base...  â† å¿½ç•¥
```

### 3.4 æ—¥å¿—å…³é”®è¯æœç´¢æŠ€å·§

**åœºæ™¯**ï¼šæ—¥å¿—å¤ªå¤šï¼Œæ€ä¹ˆå¿«é€Ÿæ‰¾åˆ°é”™è¯¯ï¼Ÿ

**æŠ€å·§1ï¼šæœç´¢ ERROR**

```bash
# åœ¨æ—¥å¿—æ–‡ä»¶ä¸­æœç´¢ ERROR
grep "ERROR" application.log
```

**æŠ€å·§2ï¼šæœç´¢å¼‚å¸¸ç±»å**

```bash
# æœç´¢ NullPointerException
grep "NullPointerException" application.log

# æœç´¢ SQLException
grep "SQLException" application.log
```

**æŠ€å·§3ï¼šæœç´¢è‡ªå·±çš„ç±»å**

```bash
# æœç´¢ CustomerService ç›¸å…³çš„æ—¥å¿—
grep "CustomerService" application.log
```

**æŠ€å·§4ï¼šåœ¨ IDEA ä¸­æœç´¢æ—¥å¿—**

1. æ‰“å¼€ `Run` çª—å£
2. æŒ‰ `Ctrl + F` æœç´¢
3. è¾“å…¥å…³é”®è¯ï¼š`ERROR`ã€`NullPointerException`ã€`CustomerService` ç­‰

---

## ç¬¬å››ç« ï¼šç”¨æ–­ç‚¹è°ƒè¯•è¿½è¸ªæµç¨‹

### 4.1 åœ¨ IDEA ä¸­è®¾ç½®æ–­ç‚¹

#### 4.1.1 åŸºæœ¬æ–­ç‚¹

**æ­¥éª¤**ï¼š
1. æ‰“å¼€ `CustomerController.java`
2. æ‰¾åˆ°ä½ æƒ³æš‚åœçš„è¡Œ
3. ç‚¹å‡»è¡Œå·å·¦ä¾§ï¼ˆå‡ºç°çº¢ç‚¹ğŸ”´ï¼‰

**ç¤ºä¾‹**ï¼š

```java
@GetMapping("/{id}")
public ResponseEntity<Customer> getCustomerById(@PathVariable String id) {
    Optional<Customer> customer = customerService.findCustomerById(id);  // â† åœ¨è¿™é‡Œè®¾ç½®æ–­ç‚¹
    return customer.map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
}
```

#### 4.1.2 å¯åŠ¨è°ƒè¯•æ¨¡å¼

**æ–¹å¼1**ï¼šç‚¹å‡» IDEA å³ä¸Šè§’çš„ ğŸï¼ˆDebug æŒ‰é’®ï¼‰

**æ–¹å¼2**ï¼šå³é”® `Main.java` â†’ `Debug 'Main.main()'`

**çœ‹åˆ°**ï¼šæ§åˆ¶å°æ˜¾ç¤º "Debugger attached"

#### 4.1.3 è§¦å‘æ–­ç‚¹

å‘èµ·è¯·æ±‚ï¼š

```bash
curl http://localhost:8080/api/customers/CUST001
```

**IDEA è‡ªåŠ¨è·³è½¬åˆ°æ–­ç‚¹ä½ç½®**ï¼Œç¨‹åºæš‚åœã€‚

### 4.2 è°ƒè¯•æ§åˆ¶æŒ‰é’®

| æŒ‰é’® | å¿«æ·é”® | åç§° | ä½œç”¨ |
|------|--------|------|------|
| â–¶ï¸ | F9 | Resume | ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ |
| â¸ï¸ | - | Pause | æš‚åœç¨‹åº |
| ğŸ”½ | F8 | Step Over | å•æ­¥è·³è¿‡ï¼ˆæ‰§è¡Œä¸‹ä¸€è¡Œï¼‰ |
| â¤µï¸ | F7 | Step Into | å•æ­¥è¿›å…¥ï¼ˆè¿›å…¥æ–¹æ³•å†…éƒ¨ï¼‰ |
| â¤´ï¸ | Shift + F8 | Step Out | è·³å‡ºå½“å‰æ–¹æ³• |
| ğŸ” | Alt + F9 | Run to Cursor | è¿è¡Œåˆ°å…‰æ ‡ä½ç½® |

### 4.3 æ¡ä»¶æ–­ç‚¹ï¼ˆåªåœ¨ç‰¹å®šæƒ…å†µä¸‹æš‚åœï¼‰

**åœºæ™¯**ï¼šå¾ªç¯å¤„ç† 1000 ä¸ªå®¢æˆ·ï¼Œä½†åªæƒ³çœ‹ `customerId = "CUST999"` çš„æƒ…å†µ

**æ­¥éª¤**ï¼š
1. å³é”®æ–­ç‚¹ï¼ˆçº¢ç‚¹ğŸ”´ï¼‰
2. é€‰æ‹© "Edit Breakpoint..."ï¼ˆæˆ–æŒ‰ Ctrl + Shift + F8ï¼‰
3. åœ¨ "Condition" è¾“å…¥æ¡†è¾“å…¥ï¼š`id.equals("CUST999")`
4. ç‚¹å‡» "Done"

**æ•ˆæœ**ï¼šåªæœ‰å½“ `id` ç­‰äº "CUST999" æ—¶æ‰ä¼šæš‚åœ

```java
@GetMapping("/{id}")
public ResponseEntity<Customer> getCustomerById(@PathVariable String id) {
    Optional<Customer> customer = customerService.findCustomerById(id);  // â† æ¡ä»¶æ–­ç‚¹ï¼šid.equals("CUST999")
    return customer.map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
}
```

### 4.4 æŸ¥çœ‹è°ƒç”¨æ ˆï¼ˆCall Stackï¼‰

**ä½œç”¨**ï¼šçœ‹å½“å‰æ–¹æ³•æ˜¯è¢«è°è°ƒç”¨çš„

**ä½ç½®**ï¼šIDEA å·¦ä¸‹è§’ "Frames" é¢æ¿

**ç¤ºä¾‹**ï¼š

```
main@1
  at com.devops.course.repository.CustomerRepository.findById(CustomerRepository.java)
  at com.devops.course.service.CustomerService.findCustomerById(CustomerService.java:32)  â† å½“å‰ä½ç½®
  at com.devops.course.controller.CustomerController.getCustomerById(CustomerController.java:45)
  at jdk.internal.reflect.DirectMethodHandleAccessor.invoke(...)
```

**è§£è¯»**ï¼š
1. CustomerController è°ƒç”¨ CustomerService
2. CustomerService è°ƒç”¨ CustomerRepository
3. å½“å‰æš‚åœåœ¨ CustomerService:32

### 4.5 æŸ¥çœ‹å˜é‡å€¼ï¼ˆVariablesï¼‰

**ä½ç½®**ï¼šIDEA å·¦ä¸‹è§’ "Variables" é¢æ¿

**ç¤ºä¾‹**ï¼š

```
this = CustomerService@1234
customerRepository = CustomerRepository@5678
customerId = "CUST001"  â† æ–¹æ³•å‚æ•°
customer = Optional[Customer@9999]  â† å±€éƒ¨å˜é‡
```

**æŠ€å·§**ï¼š
- é¼ æ ‡æ‚¬åœåœ¨å˜é‡ä¸Šï¼Œä¹Ÿèƒ½çœ‹åˆ°å€¼
- å³é”®å˜é‡ â†’ "Evaluate Expression"ï¼Œå¯ä»¥æ‰§è¡Œè¡¨è¾¾å¼

---

## ç¬¬äº”ç« ï¼šé˜…è¯»å¤æ‚ä»£ç çš„æŠ€å·§

### 5.1 ä»æ¥å£å…¥æ‰‹ï¼ˆçœ‹æ–¹æ³•ç­¾åï¼‰

**ä¸è¦ç›´æ¥çœ‹å®ç°ç»†èŠ‚ï¼Œå…ˆçœ‹æ¥å£ï¼**

**ç¤ºä¾‹**ï¼š

```java
@RestController
@RequestMapping("/api/customers")
public class CustomerController {

    // å…ˆçœ‹æ–¹æ³•ç­¾åï¼Œç†è§£è¿™ä¸ªæ–¹æ³•å¹²ä»€ä¹ˆ
    @GetMapping("/{id}")
    public ResponseEntity<Customer> getCustomerById(@PathVariable String id) {
        // å†çœ‹å®ç°ç»†èŠ‚
        Optional<Customer> customer = customerService.findCustomerById(id);
        return customer.map(ResponseEntity::ok)
                .orElse(ResponseEntity.notFound().build());
    }
}
```

**ä»æ–¹æ³•ç­¾åçŸ¥é“**ï¼š
- è¾“å…¥ï¼š`String id`ï¼ˆå®¢æˆ·IDï¼‰
- è¾“å‡ºï¼š`ResponseEntity<Customer>`ï¼ˆè¿”å›å®¢æˆ·ä¿¡æ¯æˆ–404ï¼‰
- åŠŸèƒ½ï¼šæ ¹æ® ID æŸ¥è¯¢å®¢æˆ·

### 5.2 å…ˆçœ‹ä¸»æµç¨‹ï¼Œå¿½ç•¥ç»†èŠ‚

**åŸåˆ™**ï¼šç¬¬ä¸€éåªçœ‹ä¸»çº¿é€»è¾‘ï¼Œä¸è¦æ·±å…¥ç»†èŠ‚

**é”™è¯¯åšæ³•**ï¼š

```java
public void processOrder(Order order) {
    // ç¬¬ä¸€éå°±æ·±å…¥æ¯ä¸ªæ–¹æ³•
    validateOrder(order);  // â† ç‚¹è¿›å»çœ‹å®ç°
        validateCustomer(...);  // â† åˆç‚¹è¿›å»
            checkCustomerStatus(...);  // â† åˆç‚¹è¿›å»
                // ... é™·å…¥ç»†èŠ‚ï¼Œè¿·å¤±æ–¹å‘
}
```

**æ­£ç¡®åšæ³•**ï¼š

```java
public void processOrder(Order order) {
    // ç¬¬ä¸€éï¼šåªçœ‹ä¸»æµç¨‹ï¼Œç†è§£åšäº†å“ªå‡ æ­¥
    validateOrder(order);          // 1. éªŒè¯è®¢å•
    calculatePrice(order);         // 2. è®¡ç®—ä»·æ ¼
    reserveInventory(order);       // 3. é¢„ç•™åº“å­˜
    createPayment(order);          // 4. åˆ›å»ºæ”¯ä»˜
    sendNotification(order);       // 5. å‘é€é€šçŸ¥

    // ç¬¬äºŒéï¼šå†æ·±å…¥æ¯ä¸ªæ–¹æ³•çš„ç»†èŠ‚
}
```

### 5.3 ç”¨ UML å›¾ç†è§£ç±»å…³ç³»ï¼ˆIDEA è‡ªåŠ¨ç”Ÿæˆï¼‰

**æ­¥éª¤**ï¼š
1. æ‰“å¼€ `CustomerController.java`
2. å³é”®ç±»å â†’ "Diagrams" â†’ "Show Diagram"
3. é€‰æ‹© "Java Class Diagrams"

**çœ‹åˆ°**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CustomerController â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ uses
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CustomerService   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ uses
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CustomerRepository  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç†è§£**ï¼š
- CustomerController ä¾èµ– CustomerService
- CustomerService ä¾èµ– CustomerRepository
- å…¸å‹çš„ä¸‰å±‚æ¶æ„

### 5.4 ç”¨æ³¨é‡Šæ ‡è®°é‡ç‚¹é€»è¾‘

**é˜…è¯»å¤æ‚ä»£ç æ—¶ï¼ŒåŠ ä¸Šè‡ªå·±çš„æ³¨é‡Šï¼**

```java
public void processComplexBusiness(String customerId) {
    // TODO: ææ¸…æ¥šè¿™é‡Œä¸ºä»€ä¹ˆè¦æŸ¥ä¸¤æ¬¡æ•°æ®åº“
    Customer customer = repository.findById(customerId).orElseThrow();
    Customer refreshed = repository.findById(customerId).orElseThrow();

    // FIXME: è¿™é‡Œæœ‰æ€§èƒ½é—®é¢˜ï¼Œå¾ªç¯æŸ¥è¯¢æ•°æ®åº“
    for (Order order : customer.getOrders()) {
        OrderDetail detail = orderRepository.findById(order.getId()).orElse(null);
        // ...
    }
}
```

### 5.5 å¦‚ä½•ç”¨ Claude Code å¸®ä½ ç†è§£ä»£ç 

**åœºæ™¯**ï¼šçœ‹åˆ°ä¸€æ®µå¤æ‚ä»£ç ï¼Œçœ‹ä¸æ‡‚

**åšæ³•**ï¼š

1. é€‰ä¸­ä»£ç 
2. å³é”® â†’ "Ask Claude"ï¼ˆæˆ–ä½¿ç”¨å¿«æ·é”®ï¼‰
3. é—®ï¼š"è¿™æ®µä»£ç æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ"

**Claude ä¼šå›ç­”**ï¼š

> è¿™æ®µä»£ç å®ç°äº†å®¢æˆ·è®¢å•çš„æ‰¹é‡å¤„ç†é€»è¾‘ï¼š
> 1. é¦–å…ˆæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯
> 2. éå†å®¢æˆ·çš„æ‰€æœ‰è®¢å•
> 3. å¯¹æ¯ä¸ªè®¢å•è®¡ç®—æ€»é‡‘é¢
> 4. å¦‚æœè®¢å•é‡‘é¢è¶…è¿‡1000å…ƒï¼Œæ ‡è®°ä¸ºVIPè®¢å•
> 5. æœ€åæ‰¹é‡æ›´æ–°è®¢å•çŠ¶æ€

**æ›´å¤šç”¨æ³•**ï¼š
- "è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ Optionalï¼Ÿ"
- "è¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜å—ï¼Ÿ"
- "å¦‚ä½•ä¼˜åŒ–è¿™æ®µä»£ç çš„æ€§èƒ½ï¼Ÿ"

---

## ç¬¬å…­ç« ï¼šå®æˆ˜æ¡ˆä¾‹ - å®šä½ä¸€ä¸ª Bug

### 6.1 é—®é¢˜æè¿°

**ç”¨æˆ·æŠ¥å‘Š**ï¼š

> æˆ‘æ— æ³•åˆ›å»ºæ–°å®¢æˆ·ï¼Œç‚¹å‡»"åˆ›å»ºå®¢æˆ·"æŒ‰é’®åï¼Œé¡µé¢æ˜¾ç¤º"500 Internal Server Error"ï¼Œä½†æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºæ˜¯æˆåŠŸçš„ï¼Œç¬¬äºŒæ¬¡å°±å¤±è´¥äº†ã€‚

### 6.2 ä»ç”¨æˆ·æŠ¥é”™å¼€å§‹

**æ­¥éª¤1ï¼šå¤ç°é—®é¢˜**

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®å®¢æˆ·ç®¡ç†é¡µé¢
2. å¡«å†™å®¢æˆ·ä¿¡æ¯ï¼š
   - å®¢æˆ·IDï¼šCUST888
   - å®¢æˆ·åç§°ï¼šæµ‹è¯•å®¢æˆ·
3. ç‚¹å‡»"åˆ›å»ºå®¢æˆ·"æŒ‰é’®
4. **ç¬¬ä¸€æ¬¡**ï¼šæˆåŠŸåˆ›å»º âœ…
5. å†æ¬¡å¡«å†™ç›¸åŒä¿¡æ¯ï¼Œç‚¹å‡»"åˆ›å»ºå®¢æˆ·"
6. **ç¬¬äºŒæ¬¡**ï¼šæŠ¥é”™ âŒ

**ç¡®è®¤é—®é¢˜å¯å¤ç°**ã€‚

### 6.3 çœ‹æ—¥å¿—æ‰¾å¼‚å¸¸

**æ­¥éª¤2ï¼šæŸ¥çœ‹æµè§ˆå™¨ Network é¢æ¿**

```
POST http://localhost:8080/api/customers
Status: 500 Internal Server Error
```

**æ­¥éª¤3ï¼šæŸ¥çœ‹ Response**

```json
{
  "timestamp": "2025-11-17T11:00:00Z",
  "status": 500,
  "error": "Internal Server Error",
  "message": "could not execute statement",
  "path": "/api/customers"
}
```

**æ­¥éª¤4ï¼šæŸ¥çœ‹æœåŠ¡ç«¯æ—¥å¿—**

```
2025-11-17 11:00:00.123 ERROR 12345 --- [nio-8080-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   :
ORA-00001: unique constraint (TCBS.CUSTOMERS_PK) violated

java.sql.SQLIntegrityConstraintViolationException: ORA-00001: unique constraint (TCBS.CUSTOMERS_PK) violated
    at com.devops.course.service.CustomerService.saveCustomer(CustomerService.java:54)
    at com.devops.course.controller.CustomerController.createCustomer(CustomerController.java:45)
```

**å…³é”®ä¿¡æ¯**ï¼š
- é”™è¯¯ï¼š`ORA-00001: unique constraint violated`ï¼ˆä¸»é”®å†²çªï¼‰
- ä½ç½®ï¼š`CustomerController.java:45`

### 6.4 æ‰“æ–­ç‚¹è¿½è¸ª

**æ­¥éª¤5ï¼šåœ¨ CustomerController.java:45 è®¾ç½®æ–­ç‚¹**

```java
@PostMapping
public ResponseEntity<Customer> createCustomer(@RequestBody Customer customer) {
    Customer savedCustomer = customerService.saveCustomer(customer);  // â† æ–­ç‚¹
    return ResponseEntity.status(HttpStatus.CREATED).body(savedCustomer);
}
```

**æ­¥éª¤6ï¼šå¯åŠ¨è°ƒè¯•æ¨¡å¼**

ç‚¹å‡» IDEA çš„ ğŸ æŒ‰é’®

**æ­¥éª¤7ï¼šå†æ¬¡å‘èµ·è¯·æ±‚**

```bash
curl -X POST http://localhost:8080/api/customers \
  -H "Content-Type: application/json" \
  -d '{"customerId":"CUST888","customerName":"æµ‹è¯•å®¢æˆ·"}'
```

**ç¨‹åºæš‚åœåœ¨æ–­ç‚¹**

**æ­¥éª¤8ï¼šæŸ¥çœ‹å˜é‡å€¼**

```
customer = Customer(customerId=CUST888, customerName=æµ‹è¯•å®¢æˆ·, ...)
```

**æ­¥éª¤9ï¼šå•æ­¥è¿›å…¥ saveCustomer æ–¹æ³•**ï¼ˆæŒ‰ F7ï¼‰

```java
@Transactional
public Customer saveCustomer(Customer customer) {
    return customerRepository.save(customer);  // â† æš‚åœåœ¨è¿™é‡Œ
}
```

**æ­¥éª¤10ï¼šç»§ç»­æ‰§è¡Œ**ï¼ˆæŒ‰ F9ï¼‰

**æŠ›å‡ºå¼‚å¸¸**ï¼š`SQLIntegrityConstraintViolationException`

### 6.5 å®šä½åˆ°å…·ä½“ä»£ç è¡Œ

**é—®é¢˜ä½ç½®**ï¼š`CustomerController.createCustomer()`

**é—®é¢˜ä»£ç **ï¼š

```java
@PostMapping
public ResponseEntity<Customer> createCustomer(@RequestBody Customer customer) {
    // é—®é¢˜ï¼šæ²¡æœ‰æ£€æŸ¥å®¢æˆ·IDæ˜¯å¦å·²å­˜åœ¨ï¼Œç›´æ¥æ’å…¥
    Customer savedCustomer = customerService.saveCustomer(customer);
    return ResponseEntity.status(HttpStatus.CREATED).body(savedCustomer);
}
```

### 6.6 åˆ†æé—®é¢˜åŸå› 

**æ ¹æœ¬åŸå› **ï¼š
1. ç”¨æˆ·ç¬¬ä¸€æ¬¡åˆ›å»º CUST888ï¼šæˆåŠŸ âœ…
2. ç”¨æˆ·ç¬¬äºŒæ¬¡åˆ›å»º CUST888ï¼šæ•°æ®åº“ä¸»é”®å†²çª âŒ
3. ä»£ç æ²¡æœ‰æ£€æŸ¥ ID æ˜¯å¦å·²å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. åœ¨æ’å…¥å‰æ£€æŸ¥ ID æ˜¯å¦å·²å­˜åœ¨
2. å¦‚æœå·²å­˜åœ¨ï¼Œè¿”å› 409 Conflict

**ä¿®æ”¹åçš„ä»£ç **ï¼š

```java
@PostMapping
public ResponseEntity<?> createCustomer(@RequestBody Customer customer) {
    // æ£€æŸ¥å®¢æˆ·IDæ˜¯å¦å·²å­˜åœ¨
    if (customerRepository.existsById(customer.getCustomerId())) {
        return ResponseEntity.status(HttpStatus.CONFLICT)
                .body("å®¢æˆ·IDå·²å­˜åœ¨: " + customer.getCustomerId());
    }

    // ä¸å­˜åœ¨æ‰åˆ›å»º
    Customer savedCustomer = customerService.saveCustomer(customer);
    return ResponseEntity.status(HttpStatus.CREATED).body(savedCustomer);
}
```

**æµ‹è¯•ä¿®å¤**ï¼š

```bash
# ç¬¬ä¸€æ¬¡åˆ›å»ºï¼šæˆåŠŸ
curl -X POST ... -d '{"customerId":"CUST999",...}'
# è¿”å›ï¼š201 Created

# ç¬¬äºŒæ¬¡åˆ›å»ºï¼šè¿”å›å‹å¥½é”™è¯¯
curl -X POST ... -d '{"customerId":"CUST999",...}'
# è¿”å›ï¼š409 Conflict "å®¢æˆ·IDå·²å­˜åœ¨: CUST999"
```

**Bug å®šä½å’Œä¿®å¤å®Œæˆï¼** âœ…

---

## æ€»ç»“

### æ ¸å¿ƒæŠ€èƒ½æ¸…å•

é˜…è¯»ä»£ç èƒ½åŠ›ï¼š

- âœ… **å¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®**ï¼ˆ5åˆ†é’Ÿæµç¨‹ï¼‰
- âœ… **ä»ç•Œé¢å®šä½åˆ°ä»£ç **ï¼ˆURL â†’ Controller â†’ Service â†’ Repositoryï¼‰
- âœ… **ç”¨æ—¥å¿—å®šä½é—®é¢˜**ï¼ˆçœ‹å †æ ˆè·Ÿè¸ªï¼‰
- âœ… **ç”¨æ–­ç‚¹è°ƒè¯•**ï¼ˆè®¾ç½®æ–­ç‚¹ã€å•æ­¥æ‰§è¡Œã€æŸ¥çœ‹å˜é‡ï¼‰
- âœ… **é˜…è¯»å¤æ‚ä»£ç **ï¼ˆä»æ¥å£å…¥æ‰‹ã€å…ˆçœ‹ä¸»æµç¨‹ï¼‰
- âœ… **å®æˆ˜å®šä½ Bug**ï¼ˆä»æŠ¥é”™åˆ°ä¿®å¤çš„å®Œæ•´æµç¨‹ï¼‰

### ä¸‹ä¸€æ­¥

**å·²å®Œæˆ**ï¼šé˜…è¯»ä»£ç èƒ½åŠ› âœ…

**ç»§ç»­å­¦ä¹ **ï¼š
- ã€Šå®æˆ˜ç¼–å†™ä»£ç æŒ‡å—ã€‹ï¼ˆ`writing-code-guide.md`ï¼‰
- ã€Šå›¢é˜Ÿåä½œæŒ‡å—ã€‹ï¼ˆ`team-collaboration-guide.md`ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-17
**ä½œè€…**: DevOps Course Team
